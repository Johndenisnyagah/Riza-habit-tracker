<!DOCTYPE html>
<html lang="en">
  <!-- =========================================================
       Riza | Dashboard Page
       Unified with Shared Habit Summary
       ========================================================= -->
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Riza | Dashboard</title>

    <!-- Sidebar Styles -->
    <link rel="preload" href="/frontend/components/sidebar.css" as="style" />
    <link rel="stylesheet" href="/frontend/components/sidebar.css" />

    <!-- Dashboard Styles -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link rel="stylesheet" href="dashboard.css" />

    <!-- Lottie Animation -->
    <script
      src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.5/dist/dotlottie-wc.js"
      type="module"
    ></script>
  </head>

  <body>
    <div class="dashboard-container">
      <!-- ========================= SIDEBAR ========================= -->
      <div id="sidebar-container"></div>

      <!-- ====================== MAIN CONTENT ====================== -->
      <main class="main-content">
        <!-- Header -->
        <header class="dashboard-header">
          <button class="menu-toggle" aria-label="Open menu">
            <img
              src="../assets/icons/menu.svg"
              aria-hidden="true"
              class="menu-icon"
            />
          </button>
          <div class="header-text">
            <h1>Welcome back, <span>John!</span></h1>
            <p>Here‚Äôs an overview of your week</p>
          </div>
        </header>

        <!-- ===================== DASHBOARD GRID ===================== -->
        <section class="dashboard-grid" aria-label="Dashboard overview">
          <!-- Add Habit - Keep this card but modify it to be a trigger -->
          <div class="card add-habit">
            <h3>
              <img
                src="../assets/icons/plus-circle.svg"
                class="icon"
                aria-hidden="true"
              />
              Add Habit
            </h3>
            <p>Create a new habit to track</p>

            <!-- Replace the form with a button -->
            <button class="btn open-habit-modal">Get Started</button>
          </div>

          <!-- Weekly Progress Chart -->
          <div class="card progress-chart">
            <h3>
              <!-- Weekly Progress Chart icon -->
              <img
                src="../assets/icons/bar-chart-2.svg"
                class="icon"
                aria-hidden="true"
              />
              Weekly Progress
            </h3>
            <canvas
              id="progressChart"
              aria-label="Weekly Progress Chart"
            ></canvas>
          </div>

          <!-- Daily Overview -->
          <div class="card daily-overview">
            <h3>
              <img
                src="../assets/icons/sparkles.svg"
                class="icon"
                aria-hidden="true"
              />
              Daily Overview
            </h3>

            <!-- Motivation Section -->
            <div class="motivation-section">
              <div class="motivation-content">
                <blockquote id="motivationText">
                  "Small consistent steps lead to big changes."
                </blockquote>
                <div class="motivation-footer">
                  <span class="quote-category" id="quoteCategory"
                    >Consistency</span
                  >
                  <button
                    class="refresh-quote"
                    id="refreshQuote"
                    title="Get new quote"
                  >
                    <img src="../assets/icons/refresh.svg" alt="Refresh" />
                  </button>
                </div>
              </div>
            </div>

            <!-- Divider -->
            <div class="section-divider"></div>

            <!-- Check-ins Section -->
            <div class="checkins-section">
              <div class="checkins-header">
                <img
                  src="../assets/icons/check-circle.svg"
                  class="section-icon"
                  aria-hidden="true"
                />
                <h4>Today's Check-ins</h4>
              </div>
              <p class="checkins-status">3/4 habits completed</p>
              <a class="btn-outline" href="../progress/progress.html"
                >View Check-in Details</a
              >
            </div>
          </div>

          <!-- Stats -->
          <div class="card stats">
            <h3>
              <img
                src="../assets/icons/stats.svg"
                class="icon"
                aria-hidden="true"
              />
              Stats
            </h3>
            <div class="stats-content">
              <div class="stat-item">
                <div class="stat-icon">
                  <img src="../assets/icons/calendar.svg" alt="Calendar" />
                </div>
                <div class="stat-info">
                  <span class="stat-label">Total Check-ins</span>
                  <span class="stat-value" id="dashboard-total-checkins"
                    >134</span
                  >
                </div>
              </div>
              <div class="stat-item">
                <div class="stat-icon">
                  <img src="../assets/icons/flame.svg" alt="Flame" />
                </div>
                <div class="stat-info">
                  <span class="stat-label">Longest Streak</span>
                  <span class="stat-value">
                    <strong id="dashboard-longest-streak">7</strong> days
                  </span>
                </div>
              </div>
              <div class="stat-item">
                <div class="stat-icon">
                  <img src="../assets/icons/target.svg" alt="Target" />
                </div>
                <div class="stat-info">
                  <span class="stat-label">Total Habits</span>
                  <span class="stat-value" id="dashboard-total-habits">0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Current Streak -->
          <div class="card streak">
            <h3>
              <img
                src="../assets/icons/flame.svg"
                class="icon"
                aria-hidden="true"
              />
              Current Streak
            </h3>
            <div class="streak-content">
              <div class="streak-flame-container">
                <dotlottie-wc
                  id="dashboard-flame-animation"
                  src="https://lottie.host/56d7da74-9728-4b30-9850-2f882c814d31/JxaPzJMak3.lottie"
                  autoplay
                  loop
                ></dotlottie-wc>
                <div class="streak-overlay">
                  <span class="streak-number" id="dashboard-current-streak"
                    >7</span
                  >
                  <span class="streak-label">days</span>
                </div>
              </div>
              <div class="streak-milestones">
                <div class="milestone" id="dashboard-milestone-7">
                  <span class="milestone-icon">‚≠ê</span>
                  <span class="milestone-text">7 days</span>
                </div>
                <div class="milestone" id="dashboard-milestone-30">
                  <span class="milestone-icon">üèÜ</span>
                  <span class="milestone-text">30 days</span>
                </div>
                <div class="milestone" id="dashboard-milestone-100">
                  <span class="milestone-icon">üëë</span>
                  <span class="milestone-text">100 days</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Habit Summary -->
          <div class="card habit-summary">
            <h3>
              <!-- Habit Summary icon -->
              <img
                src="../assets/icons/list-tree.svg"
                class="icon"
                aria-hidden="true"
              />
              Habit Summary
            </h3>

            <!-- Filter buttons -->
            <div class="habit-filters">
              <button class="filter-btn active" data-filter="all">All</button>
              <button class="filter-btn" data-filter="daily">Daily</button>
              <button class="filter-btn" data-filter="weekdays">
                Weekdays
              </button>
              <button class="filter-btn" data-filter="weekends">
                Weekends
              </button>
              <button class="filter-btn" data-filter="custom">Custom</button>
            </div>

            <ul id="habit-list" class="habit-list" aria-live="polite"></ul>
          </div>
          <!-- The list is filled dynamically by JS -->
        </section>
        <!-- End of dashboard-grid -->

        <!-- ===================== HABIT MODAL ===================== -->
        <div id="habit-modal" class="modal" aria-hidden="true">
          <div class="modal-content">
            <div class="modal-header">
              <h3 id="modal-title">Add New Habit</h3>
              <button class="close-modal" aria-label="Close">&times;</button>
            </div>

            <div class="modal-body">
              <form id="habit-form">
                <!-- Name field -->
                <div class="form-group">
                  <label for="habit-name">Habit Name</label>
                  <input
                    type="text"
                    id="habit-name"
                    required
                    placeholder="e.g., Morning Meditation"
                  />
                </div>

                <!-- Description field -->
                <div class="form-group">
                  <label for="habit-description">Description (Optional)</label>
                  <textarea
                    id="habit-description"
                    placeholder="Why this habit matters to you..."
                  ></textarea>
                </div>

                <!-- Frequency selection -->
                <div class="form-group">
                  <label>Frequency</label>
                  <div class="frequency-options">
                    <button
                      type="button"
                      class="freq-btn active"
                      data-value="daily"
                    >
                      Daily
                    </button>
                    <button
                      type="button"
                      class="freq-btn"
                      data-value="weekdays"
                    >
                      Weekdays
                    </button>
                    <button
                      type="button"
                      class="freq-btn"
                      data-value="weekends"
                    >
                      Weekends
                    </button>
                    <button type="button" class="freq-btn" data-value="custom">
                      Custom
                    </button>
                  </div>
                </div>

                <!-- Custom days (hidden by default) -->
                <div class="form-group custom-days hidden">
                  <div class="day-checkboxes">
                    <label><input type="checkbox" value="mon" /> Mon</label>
                    <label><input type="checkbox" value="tue" /> Tue</label>
                    <label><input type="checkbox" value="wed" /> Wed</label>
                    <label><input type="checkbox" value="thu" /> Thu</label>
                    <label><input type="checkbox" value="fri" /> Fri</label>
                    <label><input type="checkbox" value="sat" /> Sat</label>
                    <label><input type="checkbox" value="sun" /> Sun</label>
                  </div>
                </div>

                <!-- Icon selection -->
                <div class="form-group">
                  <label>Choose Icon</label>
                  <div class="icon-selector" id="icon-selector">
                    <!-- Icons will be loaded dynamically from habit-icons-config.js -->
                  </div>
                </div>
              </form>
            </div>

            <div class="modal-footer">
              <button type="button" class="btn-outline cancel-btn">
                Cancel
              </button>
              <button type="button" class="btn save-btn">Save Habit</button>
              <button type="button" class="btn-danger delete-btn hidden">
                Delete
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- ==================== SCRIPTS ==================== -->
    <!-- Chart.js library for progress visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Main application script (sidebar loader, etc) -->
    <script src="/frontend/main.js"></script>
    <!-- Daily motivation quotes module -->
    <script src="../shared/daily-motivation.js"></script>
    <!-- Dashboard-specific functionality - uses shared components -->
    <script type="module" src="dashboard.js"></script>
  </body>
</html>
